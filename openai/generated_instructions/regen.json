[
    {
        "instruction": "Analyze the topological structure and reliability of AS paths by collecting BGP RIB data from the collector rrc01 for IPv6 prefixes on March 10, 2021, between 12:00 and 13:00. Identify the most common AS path lengths and list them.",
        "input": "Analyze the topological structure and reliability of AS paths for IPv6 prefixes from collector rrc01 on March 10, 2021, between 12:00 and 13:00.",
        "output": "```python\nimport pybgpstream\nfrom collections import defaultdict\n\n# Initialize BGP Stream\nstream = pybgpstream.BGPStream(\n    from_time=\"2021-03-10 12:00:00\", until_time=\"2021-03-10 13:00:00\",\n    project=\"ris\",\n    collectors=\"rrc01\",\n    record_type=\"ribs\",\n    filter=\"ipversion 6\"\n)\n\n# Store AS path lengths\nas_path_lengths = defaultdict(int)\n\n# Loop through the stream records\nfor rec in stream.records():\n    for elem in rec:\n        if elem.type == \"R\":\n            as_path = elem.fields.get('as-path', '').split()\n            path_length = len(as_path)\n            as_path_lengths[path_length] += 1\n\n# Display the most common AS path lengths\nprint(\"Most Common AS Path Lengths:\")\nfor path_length, count in sorted(as_path_lengths.items(), key=lambda x: x[1], reverse=True):\n    print(f\"Path Length {path_length}: {count} occurrences\")\n```",
        "most_similar_instructions": {
            "Analyze the preferences of AS paths using data gathered from the collector rrc07 between 08:00 and 09:00 on May 20, 2023. Examine the most common AS paths and the frequency of their occurrence. Visualize the AS topology using a network graph. Output the list of top AS paths and their corresponding frequencies.": 0.4000000000000001,
            "Analyze BGP community usage trends using data from collector rrc02 on June 1, 2021, between 00:00 and 01:00. Calculate the frequency of each BGP community and identify the top 5 most commonly used communities.": 0.36363636363636365,
            "Analyze prefix announcements and withdrawals using BGP data from collector rrc04 on February 25, 2021, between 10:00 and 11:00. Count the frequency of announcements and withdrawals for each prefix and identify the top 5 most announced and withdrawn prefixes. Generate a report displaying the top 5 prefixes for both announcements and withdrawals along with their corresponding counts.": 0.32,
            "Identify Autonomous Systems (ASes) and their corresponding peer relationships using BGP data from collector route-views2 on May 15, 2021, between 00:00 and 01:00. Extract AS path information and determine which ASes are peers for each AS. Create a report listing the AS numbers along with their peers.": 0.3076923076923077,
            "Collect BGP RIB entries from a specific collector for IPv6 prefixes announced by AS path containing ASN 56789.": 0.3050847457627119,
            "Investigate variations in local preference values associated with BGP communities using data from collector rrc03 on July 15, 2021, between 10:00 and 11:00.": 0.30303030303030304,
            "Retrieve BGP update records from the 'rrc01' collector for the time period between 2023-06-15 12:00:00 and 2023-06-15 14:00:00. Identify and extract MOAS prefixes during this time frame to explore potential multi-homing cases. Present the MOAS prefixes along with their corresponding AS path information.": 0.3010752688172043,
            "Identify Autonomous Systems (ASes) that potentially employ AS Path Prepending based on BGP data from collector route-views2 on January 15, 2021, between 00:00 and 01:00. Count and list ASes that engage in AS Path Prepending, along with the number of prepend events detected.": 0.29885057471264365,
            "Collect BGP update events from 'rrc22' collector and analyze changes in routing information for prefixes starting with '192.168'. Focus on the time range between July 10, 2023, 6:00 AM and July 11, 2023, 11:59 PM. Determine the most frequent AS path associated with announcements during this period.": 0.2857142857142857,
            "Analyze the effects of different AS relationships\u2014Peer, Customer, Provider\u2014on BGP path inflation. We'll use data collected from the rrc00 collector between 10:50 and 11:00 on April 1, 2021. Create a map that assigns the relationship between each AS pair, calculate the actual BGP path length and the graph-theoretical shortest path between each AS pair and output the list of each AS pair, their relationship type, and whether the BGP path is inflated compared to the graph's shortest path.": 0.2698412698412699
        },
        "avg_similarity_score": 0.20012753481764967
    },
    {
        "instruction": "Analyze MOAS prefixes for the month of August 2023 from the 'route-views2' collector. Identify the top 5 MOAS prefixes and their corresponding ASes.",
        "input": "Analyze MOAS prefixes from the 'route-views2' collector for the month of August 2023. Identify the top 5 MOAS prefixes and their corresponding ASes.",
        "output": "```python\nimport pybgpstream\nfrom collections import defaultdict\n\n# Configure BGPStream\nstream = pybgpstream.BGPStream(\n    project=\"ris\",\n    collectors=\"route-views2\",\n    from_time=\"2023-08-01 00:00:00 UTC\",\n    until_time=\"2023-08-31 23:59:59 UTC\",\n    record_type=\"ribs\",\n)\n\n# Dictionary to store MOAS prefixes and their ASes\nmoas_prefixes = defaultdict(set)\n\n# Loop over the stream of BGP records\nfor elem in stream:\n    as_path = elem.fields.get('as-path', '')\n    prefix = elem.fields.get('prefix', '')\n    ases = set(as_path.split())\n\n    if prefix:\n        moas_prefixes[prefix].update(ases)\n\n# Identify top 5 MOAS prefixes\nmoas_prefixes = {k: v for k, v in moas_prefixes.items() if len(v) > 1}\ntop_moas_prefixes = sorted(moas_prefixes.items(), key=lambda item: len(item[1]), reverse=True)[:5]\n\nprint(\"Top 5 MOAS Prefixes and their ASes:\")\nfor prefix, ases in top_moas_prefixes:\n    print(f\"Prefix: {prefix}, ASes: {', '.join(ases)}\")\n```",
        "most_similar_instructions": {
            "Analyze the preferences of AS paths using data gathered from the collector rrc07 between 08:00 and 09:00 on May 20, 2023. Examine the most common AS paths and the frequency of their occurrence. Visualize the AS topology using a network graph. Output the list of top AS paths and their corresponding frequencies.": 0.28205128205128205,
            "Analyze the topological structure and reliability of AS paths by collecting BGP RIB data from the collector rrc01 for IPv6 prefixes on March 10, 2021, between 12:00 and 13:00. Identify the most common AS path lengths and list them.": 0.27692307692307694,
            "Analyze prefix announcements and withdrawals using BGP data from collector rrc04 on February 25, 2021, between 10:00 and 11:00. Count the frequency of announcements and withdrawals for each prefix and identify the top 5 most announced and withdrawn prefixes. Generate a report displaying the top 5 prefixes for both announcements and withdrawals along with their corresponding counts.": 0.26506024096385544,
            "Investigate routing changes between June 1, 2023, and June 30, 2023, collected from the 'rrc03' collector. Identify the top 5 most frequent AS paths in announcements for IPv4 prefixes. Calculate the percentage of these top AS paths compared to the total number of announcements.": 0.2647058823529412,
            "Describe the changes in network reachability from July 1, 2023, to July 7, 2023, using BGP updates collected from both the 'rrc01' and 'route-views' collectors. Focus on the withdrawals of IPv6 prefixes and analyze the frequency of these withdrawals per collector.": 0.24242424242424246,
            "Generate a Python script using the PyBGPStream library to detect Multiple Origin AS (MOAS) conflicts in BGP data. The script should: Collect BGP updates for IPv4 prefixes during the time interval from '2020-01-01 00:00:00' to '2020-01-15 23:59:59' from the 'route-views' project. Identify MOAS conflicts where a prefix is announced by multiple origin ASes. Display the detected MOAS conflicts, indicating the prefix and the corresponding origin ASes.": 0.24242424242424243,
            "Retrieve BGP update records from the 'rrc01' collector for the time period between 2023-06-15 12:00:00 and 2023-06-15 14:00:00. Identify and extract MOAS prefixes during this time frame to explore potential multi-homing cases. Present the MOAS prefixes along with their corresponding AS path information.": 0.23684210526315785,
            "Analyze BGP community usage trends using data from collector rrc02 on June 1, 2021, between 00:00 and 01:00. Calculate the frequency of each BGP community and identify the top 5 most commonly used communities.": 0.2333333333333333,
            "Retrieve BGP update events during August 15, 2023, from the 'rrc04' collector. Identify announcements for prefixes with a length of exactly 16 and 24. Determine the percentage increase in the number of announcements for prefixes with a length of 24 compared to those with a length of 16.": 0.2222222222222222,
            "Retrieve BGP announcement records for IPv6 prefixes from the collector 'route-views.eqix'.": 0.21621621621621623
        },
        "avg_similarity_score": 0.1601245209879905
    }
]